version: v0.1
testId: adr-user-test
displayName: "AdrUser - ADR GET/PATCH Load Test"
description: "Tests ADR device GET (70%) and PATCH (30%) operations with distributed device allocation"
testPlan: ../../src/locust_pkg/adr_user.py
testType: Locust
engineInstances: 1
autoStop: disable
referenceIdentities:
  - kind: Engine
    type: SystemAssigned
env:
  # Azure Device Registry (ADR) Configuration - Required
  - name: ADR_SUBSCRIPTION_ID
    value: "your-subscription-id"
  - name: ADR_RESOURCE_GROUP
    value: "your-resource-group"
  - name: ADR_NAMESPACE
    value: "your-adr-namespace"
  - name: ADR_LOCATION
    value: "eastus"

  # Device Configuration - Optional (defaults shown)
  - name: DEVICE_NAME_PREFIX
    value: "device"
  - name: DEVICES_PER_USER
    value: "1"
  - name: ADR_REQUEST_INTERVAL
    value: "5"
  - name: DEVICE_ID_RANGE_SIZE
    value: "2500"

  # Azure Storage Configuration - Required for distributed device ID allocation
  # Option 1: Connection string (takes precedence)
  # - name: STORAGE_CONN_STR
  #   value: "DefaultEndpointsProtocol=https;AccountName=...;AccountKey=..."
  # Option 2: Account URL with managed identity
  - name: STORAGE_ACCOUNT_URL
    value: "https://your-storage-account.blob.core.windows.net"
  - name: STORAGE_CONTAINER_NAME
    value: "scale"
  - name: COUNTER_BLOB_PREFIX
    value: "counter"
